<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Modeling of indicator responses to single pressures with GAMMs — model_gamm • INDperform</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Modeling of indicator responses to single pressures with GAMMs — model_gamm" />
<meta property="og:description" content="model_gamm accounts for temporal autocorrelation (TAC) in the time series
by fitting Generalized Additive Mixed Models (GAMMs) that include AR or ARMA
correlation structures using the gamm function. The GAMMs
are applied to all IND~pressure combinations provided as input or only those
with significant TAC in the GAM residuals (using filter argument)." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">INDperform</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Datasets &amp; Functions
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://doi.org/10.1016/j.ecolind.2017.05.045">Quantitative framework for selecting and validating food web indicators</a>
    </li>
    <li>
      <a href="https://raw.githubusercontent.com/saskiaotto/cheatsheets/476bad4a8876939a7b3e1784a5bf61567ed4a715/Cheatsheet_INDperform_v0.1.0.pdf">Indperform cheatsheet</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/saskiaotto/INDperform">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../mailto:saskia.otto@uni-hamburg.de">
    <span class="fa fa-send"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Modeling of indicator responses to single pressures with GAMMs</h1>
    <small class="dont-index">Source: <a href='https://github.com/saskiaotto/INDperform/blob/master/R/model_gamm.R'><code>R/model_gamm.R</code></a></small>
    <div class="hidden name"><code>model_gamm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>model_gamm</code> accounts for temporal autocorrelation (TAC) in the time series
by fitting Generalized Additive Mixed Models (GAMMs) that include AR or ARMA
correlation structures using the <code><a href='https://rdrr.io/pkg/mgcv/man/gamm.html'>gamm</a></code> function. The GAMMs
are applied to all IND~pressure combinations provided as input or only those
with significant TAC in the GAM residuals (using filter argument).</p>
    </div>

    <pre class="usage"><span class='fu'>model_gamm</span><span class='op'>(</span>
  <span class='va'>init_tbl</span>,
  k <span class='op'>=</span> <span class='fl'>5</span>,
  family <span class='op'>=</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/family.html'>gaussian</a></span><span class='op'>(</span><span class='op'>)</span>,
  excl_outlier <span class='op'>=</span> <span class='cn'>NULL</span>,
  filter <span class='op'>=</span> <span class='cn'>NULL</span>,
  lme_control <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>init_tbl</th>
      <td><p>The output tibble of the <code><a href='ind_init.html'>ind_init</a></code> function.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>Choice of knots (for the smoothing function <code>s</code>); the
default is 5.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>A description of the error distribution and link to be used in the GAM.
This needs to be defined as a family function (see also <code><a href='https://rdrr.io/r/stats/family.html'>family</a></code>). All
standard family functions can be used as well some of the distribution families in
the mgcv package (see <code><a href='https://rdrr.io/pkg/mgcv/man/family.mgcv.html'>family.mgcv</a></code>; e.g.<code><a href='https://rdrr.io/pkg/mgcv/man/negbin.html'>negbin</a></code>).
Note that <code><a href='https://rdrr.io/pkg/mgcv/man/negbin.html'>nb</a></code>, which estimates <code>theta</code> parameter, cannot be used
for <code><a href='https://rdrr.io/pkg/mgcv/man/gamm.html'>gamm</a></code>.</p></td>
    </tr>
    <tr>
      <th>excl_outlier</th>
      <td><p>A list of values identified as outliers in specific
IND~pressure GAMMs, which should be excluded in this modeling step
(the output tibble of this function includes the variable
`pres_outlier`, which is a column-list containing
all indices of values with cook`s distance &gt; 1 (see below). The function
can be re-run again, then excluding all these outliers provided in
<code>$pres_outlier</code> from the the first run (see example)).</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>logical; a filter used to select specific rows in init_tbl
(row gets selected if value TRUE). That could be the <code>tac</code> column
in the <code>model_gam</code> output tibble which indicates whether the model
residuals show TAC.</p></td>
    </tr>
    <tr>
      <th>lme_control</th>
      <td><p>A specification list of the control values for the lme fit.
The default is NULL so the control settings in <code><a href='https://rdrr.io/pkg/mgcv/man/gamm.html'>gamm</a></code> are used
(list(niterEM=0,optimMethod="L-BFGS-B",returnObject=TRUE)). To overwrite these
values use best the <code><a href='https://rdrr.io/pkg/nlme/man/lmeControl.html'>lmeControl</a></code> function (see example).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a model output tibble that contains for each filtered IND~pressure pair
6 rows with the individual GAMM outputs. The structure remains the same as in
<code><a href='model_gam.html'>model_gam</a></code> except for the explained deviance, which is not computed
by the gamm function.
The selection of the final correlation structure for each IND~pressure model can be
done manually on this tibble or with an automatized routine using
<code><a href='select_model.html'>select_model</a></code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Modeling first-differenced indicator time series can be an alternative solution
to avoid temporal dependence between observations. However, this approach does
often not help reducing the significant auto-correlation while GAMMs do as found in
Otto <em>et al.</em> (2018). Such an extension implies that the single
elements of the response variable are not independent anymore and that the
correlation between the residuals at time t1 and t2 only depends on their time
difference t1 – t2 (Wood, 2006).</p>
<p>In <code>model_gamm</code> six GAMMs are computed for each filtered IND~pressure pair, i.e.</p><ol>
<li><p>no correlation structure (for AIC comparison)</p></li>
<li><p>auto-regressive error structure of order p=1 (AR1)</p></li>
<li><p>auto-regressive error structure of order p=2 (AR2)</p></li>
<li><p>auto-regressive moving average of order p=1 and q=1 (ARMA11)</p></li>
<li><p>auto-regressive moving average of order p=1 and q=2 (ARMA12)</p></li>
<li><p>auto-regressive moving average of order p=2 and q=1 (ARMA21)</p></li>
</ol>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Otto, S.A., Kadin, M., Casini, M., Torres, M.A., Blenckner, T. (2018)
A quantitative framework for selecting and validating food web indicators.
<em>Ecological Indicators</em>, 84: 619-631,
doi: https://doi.org/10.1016/j.ecolind.2017.05.045</p>
<p>Wood, S.N. (2006) Generalized Additive Models: An Introduction with R.
Chapman and Hall/CRC Press</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/mgcv/man/gamm.html'>gamm</a></code> for more information on GAMMs and
<code><a href='plot_diagnostics.html'>plot_diagnostics</a></code> for assessing the model diagnostics</p>
<p>Other IND~pressure modeling functions: 
<code><a href='find_id.html'>find_id</a>()</code>,
<code><a href='ind_init.html'>ind_init</a>()</code>,
<code><a href='model_gam.html'>model_gam</a>()</code>,
<code><a href='plot_diagnostics.html'>plot_diagnostics</a>()</code>,
<code><a href='plot_model.html'>plot_model</a>()</code>,
<code><a href='scoring.html'>scoring</a>()</code>,
<code><a href='select_model.html'>select_model</a>()</code>,
<code><a href='test_interaction.html'>test_interaction</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Using the Baltic Sea demo data in this package</span>
<span class='va'>dat_init</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ind_init.html'>ind_init</a></span><span class='op'>(</span>
  ind_tbl <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Cod <span class='op'>=</span> <span class='va'>ind_ex</span><span class='op'>$</span><span class='va'>Sprat</span><span class='op'>)</span>,
  press_tbl <span class='op'>=</span> <span class='va'>press_ex</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Fsprat"</span>, <span class='st'>"Fher"</span><span class='op'>)</span><span class='op'>]</span>,
  time <span class='op'>=</span> <span class='va'>ind_ex</span><span class='op'>[</span> ,<span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>gam_tbl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='model_gam.html'>model_gam</a></span><span class='op'>(</span><span class='va'>dat_init</span><span class='op'>)</span>
<span class='co'># Any temporal autocorrelation</span>
<span class='va'>gam_tbl</span><span class='op'>$</span><span class='va'>tac</span>
</div><div class='output co'>#&gt; [1] TRUE TRUE</div><div class='input'><span class='co'># Applying model_gamm function and passing the $tac variable as filter</span>
<span class='va'>gamm_tbl</span> <span class='op'>&lt;-</span> <span class='fu'>model_gamm</span><span class='op'>(</span><span class='va'>dat_init</span>, filter <span class='op'>=</span> <span class='va'>gam_tbl</span><span class='op'>$</span><span class='va'>tac</span><span class='op'>)</span>
<span class='co'># Use different control values for lme fit:</span>
 <span class='va'>gamm_tbl</span> <span class='op'>&lt;-</span> <span class='fu'>model_gamm</span><span class='op'>(</span>
 <span class='va'>dat_init</span>, filter <span class='op'>=</span> <span class='va'>gam_tbl</span><span class='op'>$</span><span class='va'>tac</span>,
 lme_control <span class='op'>=</span> <span class='fu'>nlme</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/nlme/man/lmeControl.html'>lmeControl</a></span><span class='op'>(</span>niterEM <span class='op'>=</span> <span class='fl'>100</span>, msMaxIter <span class='op'>=</span> <span class='fl'>200</span><span class='op'>)</span>
 <span class='op'>)</span>
<span class='co'># \donttest{</span>
 <span class='co'># run analysis will full demo dataset</span>
 <span class='va'>gam_tbl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='model_gam.html'>model_gam</a></span><span class='op'>(</span><span class='va'>ind_init_ex</span><span class='op'>)</span>
 <span class='va'>gamm_tbl</span> <span class='op'>&lt;-</span> <span class='fu'>model_gamm</span><span class='op'>(</span><span class='va'>ind_init_ex</span>, filter <span class='op'>=</span> <span class='va'>gam_tbl</span><span class='op'>$</span><span class='va'>tac</span><span class='op'>)</span>
 <span class='co'># now run the same analysis but exclude all outliers in the GAMMs</span>
 <span class='va'>gamm_tbl2</span> <span class='op'>&lt;-</span> <span class='fu'>model_gamm</span><span class='op'>(</span><span class='va'>ind_init_ex</span>, filter <span class='op'>=</span> <span class='va'>gam_tbl</span><span class='op'>$</span><span class='va'>tac</span>,
   excl_outlier <span class='op'>=</span> <span class='va'>gamm_tbl</span><span class='op'>$</span><span class='va'>pres_outlier</span><span class='op'>)</span>
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://saskiaotto.de'>Saskia A. Otto</a>, <a href='https://github.com/reneplonus'>Rene Plonus</a>, <a href='https://www.biologie.uni-hamburg.de/forschung/oekologie-biologische-ressourcen/maroeksysdyn/mitarbeiter/funk.html'>Steffen Funk</a>, Alexander Keth.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


