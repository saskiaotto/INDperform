<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Conditional bootstraps — cond_boot • INDperform</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Conditional bootstraps — cond_boot" />
<meta property="og:description" content="cond_boot creates n_boot predicted IND time series based on a
conditional bootstrap for calculating the derivatives of the resulting
smoothing curves." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">INDperform</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Datasets &amp; Functions
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://doi.org/10.1016/j.ecolind.2017.05.045">Quantitative framework for selecting and validating food web indicators</a>
    </li>
    <li>
      <a href="https://raw.githubusercontent.com/saskiaotto/cheatsheets/476bad4a8876939a7b3e1784a5bf61567ed4a715/Cheatsheet_INDperform_v0.1.0.pdf">Indperform cheatsheet</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/saskiaotto/INDperform">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../mailto:saskia.otto@uni-hamburg.de">
    <span class="fa fa-send"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Conditional bootstraps</h1>
    <small class="dont-index">Source: <a href='https://github.com/saskiaotto/INDperform/blob/master/R/cond_boot.R'><code>R/cond_boot.R</code></a></small>
    <div class="hidden name"><code>cond_boot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>cond_boot</code> creates n_boot predicted IND time series based on a
conditional bootstrap for calculating the derivatives of the resulting
smoothing curves.</p>
    </div>

    <pre class="usage"><span class='fu'>cond_boot</span>(
  <span class='no'>init_tbl</span>,
  <span class='no'>mod_tbl</span>,
  <span class='no'>excl_outlier</span>,
  <span class='no'>n_boot</span>,
  <span class='no'>ci</span>,
  <span class='no'>par_comp</span>,
  <span class='no'>no_clust</span>,
  <span class='no'>seed</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>init_tbl</th>
      <td><p>The output tibble of the <code><a href='ind_init.html'>ind_init</a></code> function.</p></td>
    </tr>
    <tr>
      <th>mod_tbl</th>
      <td><p>A model output tibble from <code><a href='model_gam.html'>model_gam</a></code>,
<code><a href='select_model.html'>select_model</a></code> or <code><a href='merge_models.html'>merge_models</a></code> representing the
best model for each IND~pressure pair.</p></td>
    </tr>
    <tr>
      <th>excl_outlier</th>
      <td><p>logical; if TRUE, the outliers excluded in the original
models will be also excluded in the bootstrapped models.</p></td>
    </tr>
    <tr>
      <th>n_boot</th>
      <td><p>Number of bootstraps. Select n_boot so that (n_boot - (n_boot *ci)) / 2
will be an integer. Otherwise, the function will increase n_boot automatically.
The default is set to 200.</p></td>
    </tr>
    <tr>
      <th>ci</th>
      <td><p>Confidence interval of the bootstrapped smoothing functions and their
derivatives. Must be between 0 and 1, default is 0.95.</p></td>
    </tr>
    <tr>
      <th>par_comp</th>
      <td><p>logical; if TRUE, the conditional bootstrap will be processed in
parallel using several clusters, which can speed up the iteration process depending
on the number of n_boot, models to bootstrap and number of processor cores.</p></td>
    </tr>
    <tr>
      <th>no_clust</th>
      <td><p>Number of clusters ("workers") for the parallel computation, with one
cluster per core. If no_clust is set to NULL default, the number of clusters is set
as the numbers of available cores – 1.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>A single value, interpreted as an integer, which specifies the seed
of the random number generator (RNG) state for reproducibility. Due to the work
splitting in the parallel computation, RNG streams are not comparable with the
stream under serial computation. To reproduce results use the same type of
computation with the same seed and number of clusters.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns the input model tibble with the following 9 columns added</p><dl class='dl-horizontal'>
  <dt><code>press_seq</code></dt><dd><p>A list-column with sequences of 100 evenly spaced pressure
             values.</p></dd>
  <dt><code>pred</code></dt><dd><p>A list-column with the predicted indicator responses
             averaged across all bootstraps (for the 100 equally spaced
             pressure values).</p></dd>
  <dt><code>pred_ci_up</code></dt><dd><p>A list-column with the upper confidence limit of the
             bootstrapped predictions.</p></dd>
  <dt><code>pred_ci_low</code></dt><dd><p>A list-column with the lower confidence limit of the
             bootstrapped predictions.</p></dd>
  <dt><code>deriv1</code></dt><dd><p>A list-column with the first derivatives of the indicator
             responses averaged across all bootstraps (for the 100 equally spaced
             pressure values).</p></dd>
  <dt><code>deriv1_ci_up</code></dt><dd><p>A list-column with the upper confidence limit of the
             bootstrapped first derivatives.</p></dd>
  <dt><code>deriv1_ci_low</code></dt><dd><p>A list-column with the lower confidence limit of the
             bootstrapped first derivatives.</p></dd>
  <dt><code>adj_n_boot</code></dt><dd><p>The number of successful bootstrap samples that was
             actually used for calculating the mean and confidence intervals of
             the predicted indicator response and the derivative.</p></dd>
  <dt><code>boot_error</code></dt><dd><p>A list-column capturing potential error messages that
             occurred as side effects when refitting the GAM(M)s on each bootstrap
             sample.</p></dd>
 
</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>cond_boot</code> produces first n_boot new IND time series by
resampling from the residuals of the original IND-Pressure GAM(M) and
adding these to the original IND time series repeatedly. For GAMMs the
correlation structure in the bootstrapped residuals is kept constant
by using the <code><a href='https://rdrr.io/r/stats/arima.sim.html'>arima.sim</a></code> function with the bootstrapped
residuals as times series of innovations and the correlation parameters
from the original model.
A separate GAM(M) is then fitted to each bootstrapped IND time series. If
errors occur during the n_boot iterations of resampling and model fitting
(e.g., convergence errors for GAMMs), the process is repeated until n_boot
models have been fitted successfully.</p>

<p>The function calculates then the first derivatives of each bootstrapped
IND time series prediction and computes a mean and confidence intervals (CI)
of both IND predictions and derivatives. The CIs are computed by sorting the
n_boot bootstrapped derivatives into ascending order and calculating the
upper and lower percentiles defined by the <code>ci</code> argument (the default
is the 2.5% and 97.5% percentiles representing the 95% CI).</p>

<p>The parallel computation in this function builds on the packages
<code>parallel</code> and <code>pbapply</code> with its function
<code><a href='https://rdrr.io/pkg/pbapply/man/pbapply.html'>pblapply</a></code>. This allows the vectorized computations
 similar to <code>lapply</code> and adds further a progress bar.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>the wrapper function <code><a href='calc_deriv.html'>calc_deriv</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
 <span class='co'># Using some models of the Baltic Sea demo data</span>
 <span class='no'>init_tbl</span> <span class='kw'>&lt;-</span> <span class='no'>ind_init_ex</span>[<span class='no'>ind_init_ex</span>$<span class='no'>id</span> <span class='kw'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>,<span class='fl'>9</span>,<span class='fl'>75</span>), ]
 <span class='no'>mod_tbl</span> <span class='kw'>&lt;-</span> <span class='no'>merge_models_ex</span>[<span class='no'>merge_models_ex</span>$<span class='no'>id</span>  <span class='kw'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>,<span class='fl'>9</span>,<span class='fl'>75</span>), ]
 <span class='no'>deriv_tbl</span> <span class='kw'>&lt;-</span> <span class='fu'>cond_boot</span>(<span class='kw'>mod_tbl</span> <span class='kw'>=</span> <span class='no'>mod_tbl</span>, <span class='kw'>init_tbl</span> <span class='kw'>=</span> <span class='no'>init_tbl</span>,
                        <span class='kw'>excl_outlier</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>n_boot</span> <span class='kw'>=</span> <span class='fl'>200</span>,      <span class='kw'>ci</span> <span class='kw'>=</span> <span class='fl'>0.95</span>,
                        <span class='kw'>par_comp</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>no_clust</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)
<span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://saskiaotto.de'>Saskia A. Otto</a>, <a href='https://github.com/reneplonus'>Rene Plonus</a>, <a href='https://www.biologie.uni-hamburg.de/forschung/oekologie-biologische-ressourcen/maroeksysdyn/mitarbeiter/funk.html'>Steffen Funk</a>, Alexander Keth.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


